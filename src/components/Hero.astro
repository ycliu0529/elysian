---
import type { HeroProps } from "@src-types/types.ts";
import ArchiveTags from "@components/ArchiveTags.astro";
import "@styles/hero.css";

const {
  title,
  description,
  is_homepage,
  is_archivepage = false,
  total_number
} = Astro.props as HeroProps;

const { globalSettings, t } = Astro.props;
---

<section class="hero-final-layout">
  <div class="hero-container-stable">
    {/* --- 26 背景層 --- */}
    <div class="hero-master-bg-text">26</div>
    
    <div class="hero-main-content">
      {/* --- 左側文字區域 --- */}
      <div class="text-side">
        <div class="title-container">
          {/* 綠點：嚴格保留位置與動畫 */}
          <span class="green-dot breathing"></span>
          
          <h1 class="hero-title-fixed">
            <div class="en-part">
              <span class="float-up" style="animation-delay: 0.1s;">E</span>
              <span class="float-up" style="animation-delay: 0.2s;">N</span>
            </div>
            <div class="route-part">
              <span class="float-up" style="animation-delay: 0.3s;">R</span>
              <span class="float-up" style="animation-delay: 0.4s;">O</span>
              <span class="float-up" style="animation-delay: 0.5s;">U</span>
              <span class="float-up" style="animation-delay: 0.6s;">T</span>
              <span class="float-up" style="animation-delay: 0.7s;">E</span>
            </div>
          </h1>
        </div>
      </div>

      {/* --- 右側圖片區域 --- */}
      <div class="image-side">
        <div class="image-box float-up-fade" style="animation-delay: 0.4s;">
          <img
            src="/my-hero.jpeg"
            alt="Hero Image"
            class="hero-img-contain" 
          />
        </div>
      </div>
    </div>

    {/* --- 底部橫線 --- */}
    <div class="hero-full-width-line"></div>
  </div>
</section>

<style>
  /* 1. 基礎容器 */
  .hero-final-layout {
      width: 100%;
      min-height: 60vh; /* 略微增加高度以適應手機垂直空間 */
      background-color: black;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: visible; 
      margin-top: -5vh;
      position: relative;
      overflow: hidden; /* <--- 必加，這是為了防止手機畫面左右晃動 */
  }

  .hero-container-stable {
      width: 90%;
      max-width: 1600px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 5;
  }

  /* 2. 背景 26 */
  .hero-master-bg-text {
      position: absolute;
      letter-spacing: -0.05em; /* 加入這行來調整字距 */
      top: 50%;
      left: 15%;
      transform: translateY(-50%) scale(0.85, 1.1);
      font-size: 28vw;
      font-weight: 900;
      color: rgba(255, 255, 255, 0.15); 
      z-index: 0;
      line-height: 0.8; 
      pointer-events: none;
      user-select: none;
      white-space: nowrap;
      opacity: 0;
      animation: steadyFadeIn 1.2s ease-out 0.6s forwards;
  }

  @keyframes steadyFadeIn {
      to { opacity: 1; transform: translateY(-50%) scale(0.85, 1.1); }
  }

  /* 3. 主要排版 */
  .hero-main-content {
    display: flex;
    flex-direction: row;
    align-items: flex-end;
    justify-content: center; /* 改成 flex-start 讓圖片向左移，緊跟在文字後 */
    gap: 5vw; /* 調整這個 gap 數值，來控制圖片離文字多遠 */
    width: 100%;
    z-index: 10;
}

  /* 4. 文字與綠點 */
  .text-side {
      flex: 0 0 auto;
      position: relative;
      z-index: 15;
  }

  .hero-title-fixed {
      display: flex; 
      flex-direction: column; 
      line-height: 0.8; 
      margin: 0; 
      font-weight: 900; 
      color: white !important;
      /* 使用 clamp 確保在小螢幕字體縮小但不破壞比例 */
      font-size: clamp(60px, 14vw, 220px); 
      width: max-content;
  }
  
  /* 嚴格保留字距 */
  .en-part { 
    font-size: 0.75em; 
    letter-spacing: -0.15em; 
  }

  .route-part { 
    font-size: 1em; 
    letter-spacing: -0.15em; 
  }

  /* 綠點：位置參數嚴格固定 */
  .green-dot {
      position: absolute; 
      width: clamp(10px, 2.5vw, 40px); 
      height: clamp(10px, 2.5vw, 40px);
      background-color: #39FF14; 
      border-radius: 50%;
      z-index: 25; 
      top: 0%; 
      left: -10%; 
      box-shadow: 0 0 20px rgba(57, 255, 20, 0.8);
  }

  .breathing { animation: breathe 3s ease-in-out infinite; }
  @keyframes breathe {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.15); opacity: 0.7; }
  }

  /* 5. 圖片區域 */
  .image-side { 
      flex: 1;
      max-width: 700px;
      display: flex; 
      align-items: flex-end;
  }

  .image-box { 
      width: 100%; 
      overflow: hidden; 
      border-radius: 4px; 
      /* 保留鏡像與進場位移 */
      transform: scaleX(-1) translateY(0); 
  }
  
  .float-up-fade {
      opacity: 0;
      animation: imgEntrance 1s ease-out forwards;
  }

  @keyframes imgEntrance {
      to { opacity: 1; transform: scaleX(-1) translateY(0); }
  }

  .hero-img-contain {
      width: 100%; 
      height: auto; 
      display: block;
      transition: transform 0.6s cubic-bezier(0.33, 1, 0.68, 1);
  }

  .image-box:hover .hero-img-contain {
      transform: scale(1.1); 
  }

  /* 6. 底部橫線：新增進場動畫 */
  .hero-full-width-line {
      width: 100%; 
      height: 1px;
      background-color: rgba(255, 255, 255, 0.3); 
      margin-top: 4vh;
      /* 新增動畫屬性 */
    transform: scaleX(0);            /* 初始狀態：寬度為 0 */
    transform-origin: center;         /* 確保從左邊開始延伸 */
    animation: lineExtend 1.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    animation-delay: 0.8s;          /* 延遲播放，等文字浮現一半時再開始跑線 */
  }
/* 定義由左往右伸長的動畫 */
@keyframes lineExtend {
    to {
        /* 1 代表原始長度(容器的100%) */
        /* 1.15 代表比現在長 15%，且不會影響版面高度或其他元件 */
        transform: scaleX(1.2);
    }
}
  /* 字體上升動畫 */
  .float-up {
      display: inline-block; opacity: 0; transform: translateY(20px);
      animation: charFloatUp 0.6s ease-out forwards;
  }
  @keyframes charFloatUp { 
      to { opacity: 1; transform: translateY(0); } 
  }

  /* --- 響應式適配區 (不更動樣式，僅微調比例) --- */

  /* 平板尺寸 (如 iPad) */
  @media (max-width: 1024px) {
      .hero-container-stable { width: 92%; }
      .hero-master-bg-text { font-size: 32vw; }
      .image-side { max-width: 50%; }
  }

  /* 手機橫屏 */
  @media (max-width: 896px) and (orientation: landscape) {
      .hero-final-layout { min-height: 100vh; }
      .hero-title-fixed { font-size: 10vw; }
  }

  /* 手機直屏 (iPhone/Android) */
  @media (max-width: 500px) {
      .hero-final-layout {
          min-height: auto;
          padding: 40px 0 20px 0; /* 底部稍微留點空間給橫線 */
          overflow: visible; 
      }

      .hero-main-content { 
          flex-direction: column; 
          align-items: flex-start; 
          gap: 25px; 
          width: 100%;
      }

      /* --- 圖片留邊排版 --- */
      .image-side {
          width: 96%;           /* 留一點邊，不全屏 */
          margin: 10px auto 0;  /* 居中對齊，並與上方文字留間距 */
          max-width: none;
          position: relative;
          z-index: 5;
          /* 取消手機觸碰反應，解決不見或延遲的問題 */
          pointer-events: none; 
      }

      .image-box {
          border-radius: 4px;   /* 恢復圓角 */
          width: 100%;
          transform: scaleX(-1); /* 維持鏡像 */
      }

      /* 強制關閉手機上的 Hover 縮放動畫 */
      .image-box:hover .hero-img-contain {
          transform: scaleX(-1) !important; /* 保持原樣，不縮放 */
      }
      /* ------------------ */

      .hero-title-fixed {
          font-size: 65px; 
          align-items: flex-start; 
          line-height: 0.8;
          padding-left: 45px; 
          position: relative;
      }

      .green-dot {
          left: 10px; 
          top: 10%; 
          width: 20px;
          height: 20px;
          z-index: 100;
      }

      .hero-full-width-line {
          margin-top: 20px; /* 恢復一點間距 */
          /* 確保手機版也套用縮短後的動畫 */
          animation: lineExtendMobile 1.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
          animation-delay: 0.8s;
      }
  }

  /* 針對手機版的動畫定義：改為 0.9 */
  @keyframes lineExtendMobile {
      to {
          transform: scaleX(0.9); 
      }
  }

  /* 針對電腦版的動畫定義：維持 1.2 */
  @keyframes lineExtend {
      to {
          transform: scaleX(1.2); 
      }
  }
      
  