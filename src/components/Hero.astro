---
import type { HeroProps } from "@src-types/types.ts";
import ArchiveTags from "@components/ArchiveTags.astro";

import "@styles/hero.css";

const {
  title,
  description,
  is_homepage,
  is_archivepage = false,
  total_number
} = Astro.props as HeroProps;

const { globalSettings, t } = Astro.props;
---

<section class="hero">
  <div class="wide-container">
    <div class="hero-wrapper">

      <div class="hero-text-wrapper">

        {/* --- 左側文字區塊 --- */}
        <div class="hero-heading-wrapper">
          <h1 
            class:list={[
              'hero-title-no-split', 
              { 'vertical-animation': globalSettings.use_page_load_animations }
            ]}
          >
            {title ? title : (
              <>
                <span class="hero-line">Notes from a</span>
                <span class="hero-line">Lifelong</span>
                <span class="hero-line">Amateur</span>
              </>
            )}
          </h1>

          {!is_homepage && (
            <>
               <div style="margin-top: 35px;"></div>
               {total_number && (
                 <h3 class:list={[{ 'vertical-animation': globalSettings.use_page_load_animations }]}>
                   {total_number}
                 </h3>
               )}
            </>
          )}
        </div>

        {/* --- 中間圖片區塊 --- */}
        <div class="hero-image-wrapper">
          <div
            class:list={[
              'hero-img-zoom-container', 
              { 'vertical-animation': globalSettings.use_page_load_animations }
            ]}
          >
            <img
              src="/my-hero.jpeg"
              alt="Hero Image"
              class="hero-zoom-img"
            />
          </div>
        </div>

        {/* --- Archive Tags --- */}
        {is_archivepage && (
          <div class="archive-tags-wrapper">
            <ArchiveTags globalSettings={globalSettings} t={t} />
          </div>
        )}

        {/* 底線動畫 */}
        <div 
          class:list={[
            'hero-separator-line', 
            { 'horizontal-line-animation': globalSettings.use_page_load_animations }
          ]}
        ></div>

      </div>
    </div>
  </div>
</section>

<style>
  /* =========================================================
     1. 放大效果強制生效區 (包含手機觸碰優化)
     ========================================================= */
  
  .hero-img-zoom-container {
      width: 100%;
      height: 100%;
      position: relative;
      overflow: hidden !important;
      border-radius: 4px;
      /* 讓觸摸感應更靈敏 */
      -webkit-tap-highlight-color: transparent;
  }

  .hero-zoom-img {
      width: 100% !important;
      height: 100% !important;
      object-fit: cover !important;
      object-position: center center !important;
      display: block !important;
      position: absolute !important;
      inset: 0 !important;
      
      /* 動畫核心 */
      transition: transform 0.8s cubic-bezier(0.16, 1, 0.3, 1) !important;
      will-change: transform;
      transform: scale(1);
  }

  /* 電腦版：滑鼠移入時放大 */
  @media (hover: hover) {
    .hero-image-wrapper:hover .hero-zoom-img {
        transform: scale(1.1) !important;
    }
  }

  /* 手機版：點擊或按住時放大 (Active 狀態) */
  @media (hover: none) {
    .hero-image-wrapper:active .hero-zoom-img {
        transform: scale(1.05) !important; /* 手機版放大 5% 較為溫和 */
    }
  }

  /* =========================================================
     2. 佈局樣式
     ========================================================= */
  .hero {
      height: 100vh;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      margin: 0;
      overflow: hidden;
      position: relative; 
      z-index: 1; 
  }
  
  .wide-container, .hero-wrapper {
      width: 100%;
      height: auto;
      display: block;
  }

  .hero-heading-wrapper {
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      z-index: 10;
  }

  .hero-title-no-split {
      line-height: 0.95;
      letter-spacing: -0.03em;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
  }

  .hero-image-wrapper {
      position: relative;
      width: 100%;
      min-height: 50vh; 
  }

  .hero-separator-line {
      width: 100%;
      height: 1px;
      background-color: rgba(255, 255, 255, 0.3); 
      margin-top: 30px;
  }

  /* 電腦版 */
  @media (min-width: 769px) {
      .hero {
          height: 92vh !important;
          min-height: 92vh !important;
          margin-bottom: -15vh;
      }
      .hero-wrapper { transform: translateY(-8vh); }
      .hero-text-wrapper {
          display: grid;
          grid-template-columns: 45% 50% 5%;
          align-items: stretch; 
      }
      .hero-heading-wrapper { grid-column: 1 / 2; padding-left: 6vw; }
      .hero-image-wrapper { grid-column: 2 / 3; height: auto; min-height: 100%; }
      .hero-title-no-split { font-size: clamp(4rem, 9.5vw, 15rem); }
      .hero-line { display: block; white-space: nowrap; }
  }

  /* 手機版修正 */
  @media (max-width: 768px) {
      .hero-wrapper {
          transform: none;
          padding: 20px;
      }
      .hero-text-wrapper {
          display: flex;
          flex-direction: column;
          gap: 20px; /* 手機版間距縮小一點 */
      }
      .hero-image-wrapper {
          width: 100%;
          aspect-ratio: 1/1; /* 貓咪圖在手機上變正方形，非常適合貓圖 */
          height: auto;
      }
      .hero-title-no-split {
          font-size: 13vw; 
          line-height: 1.1;
      }
      .hero-line {
          display: inline-block;
          white-space: normal; 
      }
  }
</style>