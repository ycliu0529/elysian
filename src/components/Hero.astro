---
import type { HeroProps } from "@src-types/types.ts";
import ArchiveTags from "@components/ArchiveTags.astro";

import "@styles/hero.css";

const {
  title,
  description,
  is_homepage,
  is_archivepage = false,
  total_number
} = Astro.props as HeroProps;

const { globalSettings, t } = Astro.props;
---

<section class="hero">
  <div class="wide-container">
    {/* 注意：原本這裡的 inline style (transform) 已經移到底下 CSS 控制。
       這樣手機版才能自動取消上提效果，避免撞到 Header。
    */}
    <div class="hero-wrapper">

      <div class="hero-text-wrapper">

        {/* --- 左側文字區塊 --- */}
        <div class="hero-heading-wrapper">
          <h1 class="hero-title-no-split">
            {title ? title : (
              <>
                {/* 原本的 inline style (white-space: nowrap) 也移到底下 CSS 了。
                   這樣手機版才能自動允許換行，防止字衝出螢幕。
                */}
                <span class="hero-line">Notes from a</span>
                <span class="hero-line">Lifelong</span>
                <span class="hero-line">Amateur</span>
              </>
            )}
          </h1>

          {!is_homepage && (
            <>
               <div style="margin-top: 35px;"></div>
               {total_number && <h3>{total_number}</h3>}
            </>
          )}
        </div>

        {/* --- 中間圖片區塊 --- */}
        <div class="hero-image-wrapper">
          <div
            class:list={[{ 'vertical-animation': globalSettings.use_page_load_animations }]}
            style="width: 100%; height: 100%; position: relative;"
          >
            <img
              src="/my-hero.jpeg"
              alt="Hero Image"
              style="
                width: 100%;
                height: 100%;
                object-fit: cover;
                object-position: center center;
                border-radius: 4px;
                display: block;
                position: absolute;
                inset: 0;
              "
            />
          </div>
        </div>

        {/* --- Archive Tags (若有的話) --- */}
        {is_archivepage && (
          <div class="archive-tags-wrapper">
            <ArchiveTags globalSettings={globalSettings} t={t} />
          </div>
        )}

      </div>
    </div>
  </div>
</section>

<style>
  /* =========================================================
     1. 全域共用設定 (手機與電腦都生效的基礎)
     ========================================================= */
  .hero {
      height: 100vh;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      margin: 0;
      overflow: hidden; /* 禁止出現捲軸 */
  }
  
  .wide-container, .hero-wrapper {
      width: 100%;
      height: auto;
      display: block;
  }

  /* 標題與文字的基本設定 */
  .hero-heading-wrapper {
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      z-index: 10;
  }

  .hero-title-no-split {
      line-height: 0.95;
      letter-spacing: -0.03em;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
  }

  /* 圖片區塊基本設定 */
  .hero-image-wrapper {
      position: relative;
      width: 100%;
      /* 這裡設 min-height 確保如果沒有內容，圖片至少還有點高度 */
      min-height: 50vh; 
  }

  /* =========================================================
     2. 電腦版設定 (螢幕寬度大於 768px 時生效)
     ★ 這裡保留了您所有的「完美比例」設定
     ========================================================= */
  @media (min-width: 769px) {
      /* 整體上提 8vh */
      .hero-wrapper {
          transform: translateY(-8vh);
      }

      .hero-text-wrapper {
          display: grid;
          /* ★ 您的黃金比例：42% 文字 | 53% 圖片 | 5% 留白 */
          grid-template-columns: 42% 53% 5%;
          align-items: stretch; /* 圖片高度強制跟隨文字 */
          height: auto;
      }

      .hero-heading-wrapper {
          grid-column: 1 / 2;
          padding: 0;
      }

      .hero-image-wrapper {
          grid-column: 2 / 3;
          height: auto; /* 在 Grid 模式下，高度自動適應 */
          min-height: 100%;
      }

      .archive-tags-wrapper {
          grid-column: 1 / span 3;
      }

      /* 電腦版字體：維持 9.5vw 的魄力 */
      .hero-title-no-split {
          font-size: clamp(4rem, 9.5vw, 14rem);
      }

      /* 電腦版：強制三行，死不換行 */
      .hero-line {
          display: block;
          white-space: nowrap;
      }
  }

  /* =========================================================
     3. 手機版/平板直式設定 (螢幕寬度小於 768px 時生效)
     ★ 這是保護機制，防止版面炸裂
     ========================================================= */
  @media (max-width: 768px) {
      /* 手機版取消上提，不然標題會被瀏海或 Header 擋住 */
      .hero-wrapper {
          transform: none;
          padding: 20px; /* 給左右一點邊距 */
      }

      .hero-text-wrapper {
          display: flex;
          flex-direction: column; /* 改為垂直排列 (上文下圖) */
          gap: 30px; /* 文字和圖片中間留點空隙 */
      }

      /* 圖片變成方形或 4:3，讓貓咪看清楚 */
      .hero-image-wrapper {
          width: 100%;
          aspect-ratio: 1/1; /* 正方形圖片 */
          height: auto;
          min-height: auto;
      }

      /* 手機版字體：稍微縮小，改用適合單欄的大小 */
      .hero-title-no-split {
          font-size: 13vw; 
          line-height: 1.1;
      }
      
      /* 手機版：允許換行！(重要) */
      /* 如果在小手機還堅持 nowrap，字會衝出螢幕右邊看不到 */
      .hero-line {
          display: inline-block; /* 或 block */
          white-space: normal; 
      }
  }
</style>