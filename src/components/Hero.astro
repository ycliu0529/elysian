---
import type { HeroProps } from "@src-types/types.ts";
import ArchiveTags from "@components/ArchiveTags.astro";

import "@styles/hero.css";

const {
  title,
  description,
  is_homepage,
  is_archivepage = false,
  total_number
} = Astro.props as HeroProps;

const { globalSettings, t } = Astro.props;
---

<section class="hero">
  <div class="wide-container">
    <div class="hero-wrapper">

      {/* --- 主要內容區域 (文字與圖片) --- */}
      <div class="hero-text-wrapper">

        {/* --- 左側文字區塊 --- */}
        <div class="hero-heading-wrapper">
          <h1 
            class:list={[
              'hero-title-no-split', 
              { 'vertical-animation': globalSettings.use_page_load_animations }
            ]}
          >
            {title ? title : (
              <>
                <span class="hero-line">Notes from a</span>
                <span class="hero-line">Lifelong</span>
                <span class="hero-line">Amateur</span>
              </>
            )}
          </h1>

          {!is_homepage && (
            <>
               <div style="margin-top: 35px;"></div>
               {total_number && (
                 <h3 class:list={[{ 'vertical-animation': globalSettings.use_page_load_animations }]}>
                   {total_number}
                 </h3>
               )}
            </>
          )}
        </div>

        {/* --- 中間圖片區塊 --- */}
        <div class="hero-image-wrapper">
          <div
            class:list={[
              'hero-img-zoom-container', 
              { 'vertical-animation': globalSettings.use_page_load_animations }
            ]}
          >
            <img
              src="/my-hero.jpeg"
              alt="Hero Image"
              class="hero-zoom-img"
            />
          </div>
        </div>

        {/* --- Archive Tags (如果有) --- */}
        {is_archivepage && (
          <div class="archive-tags-wrapper">
            <ArchiveTags globalSettings={globalSettings} t={t} />
          </div>
        )}

      </div>

      {/* ★ 修正：將底線移到橫向 Grid 容器之外，確保它佔滿 100% 寬度 ★ */}
      <div 
        class:list={[
          'hero-separator-line', 
          { 'horizontal-line-animation': globalSettings.use_page_load_animations }
        ]}
      ></div>

    </div>
  </div>
</section>

<style>
  /* =========================================================
     1. 放大效果
     ========================================================= */
  .hero-img-zoom-container {
      width: 100%;
      height: 100%;
      position: relative;
      overflow: hidden !important; 
      border-radius: 4px;
  }

  .hero-zoom-img {
      width: 100% !important;
      height: 100% !important;
      object-fit: cover !important;
      object-position: center center !important;
      display: block !important;
      position: absolute !important;
      inset: 0 !important;
      transition: transform 0.8s cubic-bezier(0.16, 1, 0.3, 1) !important;
      will-change: transform;
      transform: scale(1);
  }

  .hero-image-wrapper:hover .hero-zoom-img {
      transform: scale(1.1) !important;
  }

  /* =========================================================
     2. 佈局樣式
     ========================================================= */
  .hero {
      height: 100vh;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      margin: 0;
      overflow: hidden;
      position: relative; 
      z-index: 1; 
  }
  
  .wide-container, .hero-wrapper {
      width: 100%;
      height: auto;
      display: block;
  }

  /* 這裡是 Grid 容器 */
  .hero-text-wrapper {
      width: 100%;
  }

  .hero-heading-wrapper {
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      z-index: 10;
  }

  .hero-title-no-split {
      line-height: 0.95;
      letter-spacing: -0.03em;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
  }

  .hero-image-wrapper {
      position: relative;
      width: 100%;
      min-height: 50vh; 
  }

  /* 修正後的底線樣式 */
  .hero-separator-line {
      width: 100%;
      height: 1px;
      background-color: rgba(255, 255, 255, 0.3); 
      margin-top: 40px; /* 調整與上方內容的距離 */
      position: relative;
      z-index: 5;
  }

  /* 電腦版排版 */
  @media (min-width: 769px) {
      .hero {
          height: 92vh !important;
          min-height: 92vh !important;
          margin-bottom: -15vh;
      }

      .hero-wrapper {
          transform: translateY(-8vh);
      }

      .hero-text-wrapper {
          display: grid;
          grid-template-columns: 45% 50% 5%;
          align-items: stretch; 
          height: auto;
      }

      .hero-heading-wrapper {
          grid-column: 1 / 2;
          padding-left: 6vw; 
          z-index: 20; 
      }

      .hero-image-wrapper {
          grid-column: 2 / 3;
          height: auto;
          min-height: 100%;
          z-index: 1;
      }

      .hero-title-no-split {
          font-size: clamp(4rem, 9.5vw, 15rem);
      }

      .hero-line {
          display: block;
          white-space: nowrap;
      }
  }

  /* 手機版排版 */
  @media (max-width: 768px) {
      .hero-wrapper {
          transform: none;
          padding: 20px;
      }
      .hero-text-wrapper {
          display: flex;
          flex-direction: column;
          gap: 30px;
      }
      .hero-image-wrapper {
          width: 100%;
          aspect-ratio: 1/1;
          height: auto;
      }
      .hero-title-no-split {
          font-size: 13vw; 
          line-height: 1.1;
      }
      .hero-line {
          display: inline-block;
          white-space: normal; 
      }
  }
</style>